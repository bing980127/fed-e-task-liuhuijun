(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{2195:function(t,e,n){"use strict";n.r(e);var o=n(3385);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);var s=n(4499),a=n.n(s),r=n(4500),l=n(64);var d=function(t){n(4482),n(4483)},c=Object(l.a)(a.a,r.a,r.b,!1,d,"data-v-620bda4c",null);e.default=c.exports},3385:function(t,e,n){"use strict";var o=n(45);n(21)(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n(505)),s=o(n(404)),a=o(n(419)),r=o(n(1664)),l=o(n(3386)),d=o(n(3388)),c=o(n(3390)),u=o(n(3392)),p=o(n(3394)),f=n(1663),h=n(469),y=n(494),m=n(1802),v={name:"CourseVideo",components:{VideoPlayer:r.default,VideoPlayerEndModal:l.default,VideoPlayerControlModal:d.default,PcVideoPlayerControl:c.default,MessageModal:u.default,KeyModal:p.default},props:{vtt:{type:String,default:""},containerStyle:{type:Object,default:function(){return{}}},fileId:{type:String,default:""},playAuth:{type:String,default:""},encryptMedia:{type:Number,default:0},isTCPlayer:{type:Boolean,default:!0},playLessonStatus:{type:String,default:""},from:{type:String,default:""},playNode:{type:Number,default:0},nextLessonId:{type:Number,default:null},prevLessonId:{type:Number,default:null},playerContentData:{type:Array,default:function(){return[]}},lastWatchLessonId:{type:Number,default:null},playDuration:{type:String,default:"00:00"}},data:function(){return{player:null,uploadPlayInfo:!1,isShowEndModal:!1,isFirstTime:!0,dayId:null,lessonId:null,isShowPlaybackRatesH5:!0,playbackRates:[.8,1,1.25,1.5,1.75,2,3],playbackRatesH5:["0.8x","1x","1.25x","1.5x","1.75x","2x","3x"],rateIndex:1,isFirstShowFlowTip:!0,isLandscape:!1,isControlRateModal:!1,isControlContentModal:!1,showContent:!1,lessonName:"",isPause:!1,isWifi:(0,y.isWifi)(),reportHeartTimerId:null,appId:window.appId||"",videoConfig:{},isFirstCanplayReport:!0,isAndroid:"Android"===h.OSName,isBindRateEvent:!1,isReportEndEvent:!1,syncEndTimer:null,showModal:!1,playNextTimer:null,showKey:0}},computed:{getBasicInfo:function(){var t=this.isTCPlayer?"TENCENT":"ALI";return{courseId:window.courseId,lessonId:this.lessonId,channelType:t+"_BigCourse"}},isShowFlowTip:{get:function(){return!this.isPc&&!this.isWifi&&this.isFirstShowFlowTip},set:function(t){return t}},showInitInfo:function(){if(!this.player)return!1;var t=this.playDuration.split(":"),e=60*t[0]+Number(t[1])-Number(this.playNode)<8;return this.showModal&&this.playNode&&this.isPc&&!e}},mounted:function(){this.isAndroid&&this.onOrientationChange()},beforeDestroy:function(){clearTimeout(this.uploadPlayInfo),this.uploadPlayInfo=!1,this.clearHeartTimerId(),this.updateCourseLessonsHistory(!0,this.dayId,this.lessonId),this.player&&this.player.dispose()},methods:{initVideo:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.fileId&&e&&(this.isShowEndModal&&(this.isShowEndModal=!1,this.clearPlayNextTimer()),this.uploadPlayInfo&&(clearTimeout(this.uploadPlayInfo),this.uploadPlayInfo=!1),this.lessonName=o,this.dayId=t,this.lessonId=e,this.isReportEndEvent=!1,this.syncEndTimer&&(clearTimeout(this.syncEndTimer),this.syncEndTimer=null),this.isShowPlaybackRatesH5=!window.canHideFast,this.videoConfig={appId:window.appId,controlBar:{playbackRateMenuButton:!window.canHideFast,progressControl:!window.canHideFast},fileId:this.fileId,playAuth:this.playAuth,encryptMedia:this.encryptMedia,lessonId:e,isTCPlayer:this.isTCPlayer,autoplay:!0,playbackRates:this.playbackRates,definition:"240",plugins:{HLSToken:{token:"big_course"}},isBigCourse:!0,defaultDefinition:"HD",thumbnailUrl:this.vtt},this.$nextTick((function(){n.showModal=!0,setTimeout((function(){n.showModal=!1}),5e3)})))},changeShow:function(t){this.showKey=t},closeInitModal:function(){this.showModal=!1},startPlay:function(){this.player.setCurrentTime(0)},setRate:function(t){this.rateIndex=Number(t)},exitFullscreen:function(){this.player.exitFullscreen()},setPlayer:function(t){this.player=t,this.isShowFlowTip&&this.player&&this.player.pause()},canPlayHandler:function(){if(this.player){var t=Number(this.playNode)||0,e=this.player.getDuration();e&&e-t<=8&&(t=0),t&&this.player.setCurrentTime(t),this.setTooltipStyle(),this.bindRateDOMClick()}},bindRateDOMClick:function(){if(!this.isBindRateEvent){this.isBindRateEvent=!0;var t=document.querySelector(".vjs-playback-rate ul"),e=document.getElementsByTagName("video")[0];e&&t&&t.addEventListener("click",(function(){setTimeout((function(){sessionStorage&&sessionStorage.setItem("videoRate",e.playbackRate)}),500)}))}},playHandler:function(){this.isShowEndModal&&(this.isShowEndModal=!1,this.clearPlayNextTimer());var t=this.lessonId;"INIT"===this.playLessonStatus&&this.$emit("setLessonStatus",t,"UNFINISH"),this.isLandscape&&"INIT"===this.playLessonStatus&&this.$refs.controlModal.setLessonStudyStatus(t,"UNFINISH"),this.isPause=!1,this.isFirstCanplayReport||(this.showKey=2)},pauseHandle:function(){this.isPause=!0,this.showKey=1},timeupdateHandler:function(){this.syncPlayRecord(),this.syncReportHeart(),this.syncReportEndEvent()},syncPlayRecord:function(){var t=this;if(!this.uploadPlayInfo){var e=this.dayId,n=this.lessonId;this.uploadPlayInfo=setTimeout((function(){t.updateCourseLessonsHistory(!0,e,n),clearTimeout(t.uploadPlayInfo),t.uploadPlayInfo=!1}),3e3)}},syncReportHeart:function(){var t=this;this.reportHeartTimerId||(this.reportHeartTimerId=setTimeout((function(){(0,m.fetchCheckHeartbeat)(t.lessonId),t.clearHeartTimerId()}),1e4))},syncReportEndEvent:function(){var t=this;this.syncEndTimer||(this.syncEndTimer=setTimeout((function(){clearTimeout(t.syncEndTimer),t.syncEndTimer=null;var e=t.lessonId,n=t.dayId,o=t.player,i=t.isReportEndEvent;if(o&&!i){var s=(0,a.default)(o.getDuration()),r=(0,a.default)(o.getCurrentTime());s-r>20||!s||!r||(t.isReportEndEvent=!0,t.updateCourseLessonsHistory(!1,n,e),t.$nextTick((function(){"FINISH"!==t.playLessonStatus&&t.$emit("setLessonStatus",e,"FINISH"),t.isLandscape&&t.$refs.controlModal.setLessonStudyStatus(e,"FINISH"),t.emitPlaySyncTime()})))}}),1e3))},clearHeartTimerId:function(){clearTimeout(this.reportHeartTimerId),this.reportHeartTimerId=!1},endedHandler:function(){var t=this;clearTimeout(this.uploadPlayInfo),this.uploadPlayInfo=!1,this.clearHeartTimerId(),(this.isPc||this.isLandscape)&&(this.nextLessonId&&(this.playNextTimer=setTimeout((function(){t.$emit("switchLesson",t.nextLessonId),t.isShowEndModal=!1,t.playNextTimer=null}),3e3),this.$store.commit("autoPlayNextTimer",this.playNextTimer)),this.isShowEndModal=!0),this.emitPlaySyncTime(),setTimeout((function(){var e=t.videoConfig.isTCPlayer?".vjs-big-play-button":".prism-big-play-btn",n=document.querySelector(e);n&&(n.style.display="none")}),100)},emitPlaySyncTime:function(){var t=this;setTimeout((function(){t.$emit("playEnd")}),500)},errorHandler:function(t){(0,f.reportPlayInfo)((0,s.default)(this.getBasicInfo,{playInfo:(0,i.default)({isError:!0,error:{msg:(0,i.default)(t)}})}),!0),this.isShowFlowTip&&(this.isFirstShowFlowTip=!1)},updateCourseLessonsHistory:function(t,e,n){if("comment"!==this.$route.name){var o=t?(0,a.default)(this.player&&this.player.getCurrentTime(),10):0,i=this.$route.query.weekId,s={courseId:window.courseId,weekId:i,dayId:e,lessonId:n,playNode:o,mediaType:0,finish:!t};(0,m.fetchSaveHistory)(s)}},controlPlay:function(t){"replay"===t?this.player&&this.player.replay():"next"===t&&(this.isLandscape?this.$refs.controlModal.triggerNextLesson():this.$emit("switchLesson",this.nextLessonId)),this.isShowEndModal=!1,this.clearPlayNextTimer()},handlePlay:function(t){"next"===t?this.$emit("switchLesson",this.nextLessonId):"prev"===t&&this.$emit("switchPrevLesson")},setTooltipStyle:function(){var t=this;setTimeout((function(){var e=document.querySelector(".vjs-slider-bar .vjs-time-tooltip");e&&(e.style.display="none");var n=t.$refs.controlModal;if(t.isAndroid&&n&&n.initStyleAndDOM(),t.isShowFlowTip){var o=t.videoConfig.isTCPlayer?".vjs-big-play-button":".prism-big-play-btn",i=document.querySelector(o);i&&(i.style.display="none")}}),1e3)},playVideo:function(){this.isFirstShowFlowTip=!1,this.player&&this.player.play()},onOrientationChange:function(){var t=this,e="onorientationchange"in window?"orientationchange":"resize";window.addEventListener(e,(function(){180!==window.orientation&&0!==window.orientation||(t.isLandscape=!1,t.isShowEndModal=!1,t.clearPlayNextTimer()),90!==window.orientation&&-90!==window.orientation||(t.isLandscape=!0)}),!1)},switchContainer:function(t,e,n){this.$emit("switchContainer",t,e,n)},clearPlayNextTimer:function(){this.playNextTimer&&(clearTimeout(this.playNextTimer),this.$store.commit("autoPlayNextTimer",null))}}};e.default=v},3386:function(t,e,n){"use strict";n.r(e);var o=n(3387);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);var s=n(4485),a=n.n(s),r=n(4486),l=n(64);var d=function(t){n(4484)},c=Object(l.a)(a.a,r.a,r.b,!1,d,"data-v-6f97eea2",null);e.default=c.exports},3387:function(t,e,n){"use strict";n(21)(e,"__esModule",{value:!0}),e.default=void 0;var o={name:"VideoPlayerEndModal",props:{isShowEndModal:{type:Boolean,default:!1},isLandscape:{type:Boolean,default:!1},nextLessonId:{type:Number,default:null}},data:function(){return{}},computed:{isAppendDOM:function(){var t=document.querySelector(".video-js #endModal");if(this.isLandscape&&!t){var e=document.querySelector("#endModal");document.querySelector(".video-js").appendChild(e)}return this.isLandscape}},methods:{controlPlay:function(t){this.$emit("controlPlay",t)}}};e.default=o},3388:function(t,e,n){"use strict";n.r(e);var o=n(3389);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);var s=n(4488),a=n.n(s),r=n(4489),l=n(64);var d=function(t){n(4487)},c=Object(l.a)(a.a,r.a,r.b,!1,d,null,null);e.default=c.exports},3389:function(t,e,n){"use strict";var o=n(45);n(21)(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n(429)),s={name:"VideoPlayerControlModal",components:{Content:function(){return n.e(21).then(n.bind(null,2194))}},props:{playbackRatesH5:{type:Array,default:function(){return[]}},isShowPlaybackRatesH5:{type:Boolean,default:!0},rateIndex:{type:Number,default:null},isLandscape:{type:Boolean,default:!1},isPause:{type:Boolean,default:!1},playerContentData:{type:Array,default:function(){return[]}},lastWatchLessonId:{type:Number,default:null},lessonName:{type:String,default:""}},data:function(){return{isNeedAppendDOM:!0}},watch:{isLandscape:function(t,e){this.isNeedAppendDOM&&(this.appendDOM(t),this.isNeedAppendDOM=!1);var n=document.querySelector(".vjs-control-bar");t&&!e?(n.classList.add("fullscreen-control-bar"),document.querySelector(".video-js #videoLessonName")||document.querySelector(".video-js").appendChild(document.querySelector("#videoLessonName"))):document.querySelector(".vjs-control-bar").className="vjs-control-bar android-control-bar"}},methods:{initStyleAndDOM:function(){this.setControlBarStyle()},appendRateAndContentDOM:function(){if(!document.querySelector("#customControlBar")){var t='<div\n                            id="customControlBar"\n                            class="self-custom-control"\n                        >\n                            <button\n                                id="controlRate"\n                                class="vjs-rate-self vjs-self-btn '.concat(!this.isShowPlaybackRatesH5&&"vjs-self-btn-hide",'"\n                            >\n                                1x\n                            </button>\n                            <button\n                                id="controlContent"\n                                class="vjs-content-self vjs-self-btn"\n                            >\n                                \u76ee\u5f55\n                            </button>\n                        </div>');document.querySelector(".vjs-duration").insertAdjacentHTML("afterend",t),document.querySelector("#controlRate").addEventListener("click",(function(){document.querySelector(".vjs-control-modal").classList.add("vjs-control-modal-show-rate")})),document.querySelector("#controlContent").addEventListener("click",(function(){document.querySelector(".vjs-control-modal").classList.add("vjs-control-modal-show-content")}))}},setControlBarStyle:function(){document.querySelector(".vjs-time-divider").style.display="none",document.querySelector(".vjs-control-bar").classList.add("android-control-bar")},appendDOM:function(t){this.isLandscape&&this.appendRateAndContentDOM();var e=document.querySelector(".video-js #endModal"),n=document.querySelector(".video-js");t&&!e&&(e=document.querySelector("#endModal"),n.appendChild(e));var o=document.querySelector(".video-js #selfControlModal");t&&!o&&(o=document.querySelector("#selfControlModal"),n.appendChild(o))},clickControlModal:function(t){if("rate"===t.target.getAttribute("data-type")){var e=t.target.getAttribute("data-index"),n=this.playbackRatesH5[e];this.$emit("setRate",e),document.querySelector("#controlRate").innerText=n,window.videoContainer=document.querySelector(".video-container video"),document.querySelector(".video-container video").playbackRate=(0,i.default)(n)}document.querySelector(".vjs-control-modal").className="vjs-control-modal"},exitFullscreen:function(){this.$emit("exitFullscreen")},switchContainer:function(t,e,n){this.$emit("switchContainer",t,e,n)},setLessonStudyStatus:function(t,e){this.$refs.content.setLessonStudyStatus(t,e)},triggerNextLesson:function(){this.$refs.content.triggerNextLesson()}}};e.default=s},3390:function(t,e,n){"use strict";n.r(e);var o=n(3391);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);var s=n(4491),a=n.n(s),r=n(4492),l=n(64);var d=function(t){n(4490)},c=Object(l.a)(a.a,r.a,r.b,!1,d,"data-v-6462f782",null);e.default=c.exports},3391:function(t,e,n){"use strict";n(21)(e,"__esModule",{value:!0}),e.default=void 0;var o={name:"PcVideoPlayerControl",props:{nextLessonId:{type:Number,default:null},player:{type:Object,default:null}},data:function(){return{isNeedAppendDOM:!0}},watch:{},mounted:function(){this.initDom()},methods:{initDom:function(){setTimeout((function(){var t=document.getElementsByClassName("vjs-control-bar")[0];if(t){var e=t.getElementsByClassName("vjs-play-control")[0],n=t.getElementsByClassName("vjs-volume-panel")[0],o=t.getElementsByClassName("vjs-playback-rate")[0],i=document.getElementById("pc-control-prev"),s=document.getElementById("pc-control-next");t.insertBefore(i,e),t.insertBefore(s,e.nextSibling),t.insertBefore(n,o)}}),3e3)},handleClick:function(t){this.$emit("handlePlay",t)}}};e.default=o},3392:function(t,e,n){"use strict";n.r(e);var o=n(3393);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);var s=n(4494),a=n.n(s),r=n(4495),l=n(64);var d=function(t){n(4493)},c=Object(l.a)(a.a,r.a,r.b,!1,d,"data-v-7f1163b7",null);e.default=c.exports},3393:function(t,e,n){"use strict";n(21)(e,"__esModule",{value:!0}),e.default=void 0;var o={name:"VideoMessageModal",props:{playNode:{type:Number,default:0}},data:function(){return{isShow:!0}},computed:{minute:function(){return String(Math.floor(this.playNode/60)).padStart(2,"0")},second:function(){return String(this.playNode%60).padStart(2,"0")}},mounted:function(){},methods:{startPlay:function(){this.$emit("startPlay")},close:function(){this.$emit("close")}}};e.default=o},3394:function(t,e,n){"use strict";n.r(e);var o=n(3395);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);var s=n(4497),a=n.n(s),r=n(4498),l=n(64);var d=function(t){n(4496)},c=Object(l.a)(a.a,r.a,r.b,!1,d,"data-v-ec390c74",null);e.default=c.exports},3395:function(t,e,n){"use strict";n(21)(e,"__esModule",{value:!0}),e.default=void 0;var o={props:{show:{type:Number,default:1}},data:function(){return{timer:null}},watch:{show:{handler:function(t){this.timer&&clearTimeout(this.timer),this.clearIcon()},immediate:!0}},mounted:function(){},methods:{clearIcon:function(){var t=this;this.timer=setTimeout((function(){t.$emit("changeShow",0)}),300)}}};e.default=o},4482:function(t,e,n){},4483:function(t,e,n){},4484:function(t,e,n){},4485:function(t,e,n){"use strict";n(21)(e,"__esModule",{value:!0}),e.default=void 0;var o={name:"VideoPlayerEndModal",props:{isShowEndModal:{type:Boolean,default:!1},isLandscape:{type:Boolean,default:!1},nextLessonId:{type:Number,default:null}},data:function(){return{}},computed:{isAppendDOM:function(){var t=document.querySelector(".video-js #endModal");if(this.isLandscape&&!t){var e=document.querySelector("#endModal");document.querySelector(".video-js").appendChild(e)}return this.isLandscape}},methods:{controlPlay:function(t){this.$emit("controlPlay",t)}}};e.default=o},4486:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowEndModal,expression:"isShowEndModal"}],class:{"end-modal-h5":t.isLandscape,"end-modal":!0},attrs:{id:"endModal"}},[n("div",{staticClass:"end-modal-content"},[t.isLandscape?t._e():n("div",{staticClass:"end-modal-title"},[t._v("\n            \u89c6\u9891\u64ad\u653e\u5b8c\u6210\n        ")]),t._v(" "),n("div",{staticClass:"end-modal-operate"},[n("div",{staticClass:"operate-btn replay",on:{click:function(e){return t.controlPlay("replay")}}},[t._m(0),t._v(" "),n("div",{staticClass:"operate-letter"},[t._v("\n                    \u91cd\u64ad\n                ")])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.nextLessonId,expression:"nextLessonId"}],staticClass:"operate-btn next",on:{click:function(e){return t.controlPlay("next")}}},[t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),n("div",{staticClass:"operate-letter"},[t._v("\n                    \u5b66\u4e60\u4e0b\u4e00\u8282\n                ")])])])])])},i=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"operate-icon"},[e("span",{staticClass:"kw-icon-replay play-icon"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"right"},[e("div",{staticClass:"rightcircle"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left"},[e("div",{staticClass:"leftcircle"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"operate-icon"},[e("span",{staticClass:"kw-icon-play-next play-icon"})])}]},4487:function(t,e,n){},4488:function(t,e,n){"use strict";var o=n(45);n(21)(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n(429)),s={name:"VideoPlayerControlModal",components:{Content:function(){return n.e(21).then(n.bind(null,2194))}},props:{playbackRatesH5:{type:Array,default:function(){return[]}},isShowPlaybackRatesH5:{type:Boolean,default:!0},rateIndex:{type:Number,default:null},isLandscape:{type:Boolean,default:!1},isPause:{type:Boolean,default:!1},playerContentData:{type:Array,default:function(){return[]}},lastWatchLessonId:{type:Number,default:null},lessonName:{type:String,default:""}},data:function(){return{isNeedAppendDOM:!0}},watch:{isLandscape:function(t,e){this.isNeedAppendDOM&&(this.appendDOM(t),this.isNeedAppendDOM=!1);var n=document.querySelector(".vjs-control-bar");t&&!e?(n.classList.add("fullscreen-control-bar"),document.querySelector(".video-js #videoLessonName")||document.querySelector(".video-js").appendChild(document.querySelector("#videoLessonName"))):document.querySelector(".vjs-control-bar").className="vjs-control-bar android-control-bar"}},methods:{initStyleAndDOM:function(){this.setControlBarStyle()},appendRateAndContentDOM:function(){if(!document.querySelector("#customControlBar")){var t='<div\n                            id="customControlBar"\n                            class="self-custom-control"\n                        >\n                            <button\n                                id="controlRate"\n                                class="vjs-rate-self vjs-self-btn '.concat(!this.isShowPlaybackRatesH5&&"vjs-self-btn-hide",'"\n                            >\n                                1x\n                            </button>\n                            <button\n                                id="controlContent"\n                                class="vjs-content-self vjs-self-btn"\n                            >\n                                \u76ee\u5f55\n                            </button>\n                        </div>');document.querySelector(".vjs-duration").insertAdjacentHTML("afterend",t),document.querySelector("#controlRate").addEventListener("click",(function(){document.querySelector(".vjs-control-modal").classList.add("vjs-control-modal-show-rate")})),document.querySelector("#controlContent").addEventListener("click",(function(){document.querySelector(".vjs-control-modal").classList.add("vjs-control-modal-show-content")}))}},setControlBarStyle:function(){document.querySelector(".vjs-time-divider").style.display="none",document.querySelector(".vjs-control-bar").classList.add("android-control-bar")},appendDOM:function(t){this.isLandscape&&this.appendRateAndContentDOM();var e=document.querySelector(".video-js #endModal"),n=document.querySelector(".video-js");t&&!e&&(e=document.querySelector("#endModal"),n.appendChild(e));var o=document.querySelector(".video-js #selfControlModal");t&&!o&&(o=document.querySelector("#selfControlModal"),n.appendChild(o))},clickControlModal:function(t){if("rate"===t.target.getAttribute("data-type")){var e=t.target.getAttribute("data-index"),n=this.playbackRatesH5[e];this.$emit("setRate",e),document.querySelector("#controlRate").innerText=n,window.videoContainer=document.querySelector(".video-container video"),document.querySelector(".video-container video").playbackRate=(0,i.default)(n)}document.querySelector(".vjs-control-modal").className="vjs-control-modal"},exitFullscreen:function(){this.$emit("exitFullscreen")},switchContainer:function(t,e,n){this.$emit("switchContainer",t,e,n)},setLessonStudyStatus:function(t,e){this.$refs.content.setLessonStudyStatus(t,e)},triggerNextLesson:function(){this.$refs.content.triggerNextLesson()}}};e.default=s},4489:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"vjs-control-modal",attrs:{id:"selfControlModal"},on:{click:function(e){return e.stopPropagation(),t.clickControlModal(e)}}},[t.isShowPlaybackRatesH5?n("div",{staticClass:"vjs-control-modal-rate vjs-control-modal-container"},t._l(t.playbackRatesH5,(function(e,o){return n("button",{key:o,class:{"vjs-control-modal-rate-item":!0,"vjs-control-modal-rate-item-hover":o===t.rateIndex},attrs:{"data-type":"rate","data-index":o}},[t._v("\n                "+t._s(e)+"\n            ")])})),0):t._e(),t._v(" "),n("div",{staticClass:"vjs-control-modal-content vjs-control-modal-container"},[t.isLandscape?n("Content",{ref:"content",attrs:{"player-content-data":t.playerContentData,"last-watch-lesson-id":t.lastWatchLessonId},on:{switchContainer:t.switchContainer}}):t._e()],1)]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isLandscape&&t.isPause,expression:"isLandscape && isPause"}],staticClass:"video-lesson-name",attrs:{id:"videoLessonName"}},[n("span",{staticClass:"kw-icon-back",on:{click:t.exitFullscreen}}),t._v(" "),n("span",{staticClass:"lesson-name-title"},[t._v(t._s(t.lessonName))])])])},i=[]},4490:function(t,e,n){},4491:function(t,e,n){"use strict";n(21)(e,"__esModule",{value:!0}),e.default=void 0;var o={name:"PcVideoPlayerControl",props:{nextLessonId:{type:Number,default:null},player:{type:Object,default:null}},data:function(){return{isNeedAppendDOM:!0}},watch:{},mounted:function(){this.initDom()},methods:{initDom:function(){setTimeout((function(){var t=document.getElementsByClassName("vjs-control-bar")[0];if(t){var e=t.getElementsByClassName("vjs-play-control")[0],n=t.getElementsByClassName("vjs-volume-panel")[0],o=t.getElementsByClassName("vjs-playback-rate")[0],i=document.getElementById("pc-control-prev"),s=document.getElementById("pc-control-next");t.insertBefore(i,e),t.insertBefore(s,e.nextSibling),t.insertBefore(n,o)}}),3e3)},handleClick:function(t){this.$emit("handlePlay",t)}}};e.default=o},4492:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"vjs-control-pc",attrs:{id:"pcControl"}},[n("div",{staticClass:"pc-control-prev",attrs:{id:"pc-control-prev"}},[n("span",{staticClass:"pc-control-prev-img",on:{click:function(e){return e.stopPropagation(),t.handleClick("prev")}}}),t._v(" "),n("span",{staticClass:"prev-title"},[t._v("\u4e0a\u4e00\u8282")])]),t._v(" "),n("div",{staticClass:"pc-control-next",attrs:{id:"pc-control-next"}},[n("span",{staticClass:"pc-control-next-img",on:{click:function(e){return e.stopPropagation(),t.handleClick("next")}}}),t._v(" "),n("span",{staticClass:"next-title"},[t._v("\u4e0b\u4e00\u8282")])])])])},i=[]},4493:function(t,e,n){},4494:function(t,e,n){"use strict";n(21)(e,"__esModule",{value:!0}),e.default=void 0;var o={name:"VideoMessageModal",props:{playNode:{type:Number,default:0}},data:function(){return{isShow:!0}},computed:{minute:function(){return String(Math.floor(this.playNode/60)).padStart(2,"0")},second:function(){return String(this.playNode%60).padStart(2,"0")}},mounted:function(){},methods:{startPlay:function(){this.$emit("startPlay")},close:function(){this.$emit("close")}}};e.default=o},4495:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isShow?n("div",{staticClass:"video-message-modal"},[n("span",[t._v("\n        \u60a8\u4e0a\u6b21\u5b66\u4e60\u5230 "+t._s(t.minute)+":"+t._s(t.second)+" \u5df2\u4e3a\u60a8\u81ea\u52a8\u7eed\u64ad\n        "),n("button",{staticClass:"theme_text",on:{click:t.startPlay}},[t._v("\u4ece\u5934\u89c2\u770b")]),t._v(" "),n("span",{staticClass:"cancel",on:{click:t.close}})])]):t._e()},i=[]},4496:function(t,e,n){},4497:function(t,e,n){"use strict";n(21)(e,"__esModule",{value:!0}),e.default=void 0;var o={props:{show:{type:Number,default:1}},data:function(){return{timer:null}},watch:{show:{handler:function(t){this.timer&&clearTimeout(this.timer),this.clearIcon()},immediate:!0}},mounted:function(){},methods:{clearIcon:function(){var t=this;this.timer=setTimeout((function(){t.$emit("changeShow",0)}),300)}}};e.default=o},4498:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"key-modal"},[n("transition",{attrs:{name:"fade"}},[1==t.show?n("p",[n("span",{staticClass:"key_stop"})]):t._e(),t._v(" "),2==t.show?n("p",[n("span",{staticClass:"key_play"})]):t._e(),t._v(" "),3==t.show?n("p",[n("span",{staticClass:"key_back"})]):t._e(),t._v(" "),4==t.show?n("p",[n("span",{staticClass:"key_forward"})]):t._e()])],1)},i=[]},4499:function(t,e,n){"use strict";var o=n(45);n(21)(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n(505)),s=o(n(404)),a=o(n(419)),r=o(n(1664)),l=o(n(3386)),d=o(n(3388)),c=o(n(3390)),u=o(n(3392)),p=o(n(3394)),f=n(1663),h=n(469),y=n(494),m=n(1802),v={name:"CourseVideo",components:{VideoPlayer:r.default,VideoPlayerEndModal:l.default,VideoPlayerControlModal:d.default,PcVideoPlayerControl:c.default,MessageModal:u.default,KeyModal:p.default},props:{vtt:{type:String,default:""},containerStyle:{type:Object,default:function(){return{}}},fileId:{type:String,default:""},playAuth:{type:String,default:""},encryptMedia:{type:Number,default:0},isTCPlayer:{type:Boolean,default:!0},playLessonStatus:{type:String,default:""},from:{type:String,default:""},playNode:{type:Number,default:0},nextLessonId:{type:Number,default:null},prevLessonId:{type:Number,default:null},playerContentData:{type:Array,default:function(){return[]}},lastWatchLessonId:{type:Number,default:null},playDuration:{type:String,default:"00:00"}},data:function(){return{player:null,uploadPlayInfo:!1,isShowEndModal:!1,isFirstTime:!0,dayId:null,lessonId:null,isShowPlaybackRatesH5:!0,playbackRates:[.8,1,1.25,1.5,1.75,2,3],playbackRatesH5:["0.8x","1x","1.25x","1.5x","1.75x","2x","3x"],rateIndex:1,isFirstShowFlowTip:!0,isLandscape:!1,isControlRateModal:!1,isControlContentModal:!1,showContent:!1,lessonName:"",isPause:!1,isWifi:(0,y.isWifi)(),reportHeartTimerId:null,appId:window.appId||"",videoConfig:{},isFirstCanplayReport:!0,isAndroid:"Android"===h.OSName,isBindRateEvent:!1,isReportEndEvent:!1,syncEndTimer:null,showModal:!1,playNextTimer:null,showKey:0}},computed:{getBasicInfo:function(){var t=this.isTCPlayer?"TENCENT":"ALI";return{courseId:window.courseId,lessonId:this.lessonId,channelType:t+"_BigCourse"}},isShowFlowTip:{get:function(){return!this.isPc&&!this.isWifi&&this.isFirstShowFlowTip},set:function(t){return t}},showInitInfo:function(){if(!this.player)return!1;var t=this.playDuration.split(":"),e=60*t[0]+Number(t[1])-Number(this.playNode)<8;return this.showModal&&this.playNode&&this.isPc&&!e}},mounted:function(){this.isAndroid&&this.onOrientationChange()},beforeDestroy:function(){clearTimeout(this.uploadPlayInfo),this.uploadPlayInfo=!1,this.clearHeartTimerId(),this.updateCourseLessonsHistory(!0,this.dayId,this.lessonId),this.player&&this.player.dispose()},methods:{initVideo:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.fileId&&e&&(this.isShowEndModal&&(this.isShowEndModal=!1,this.clearPlayNextTimer()),this.uploadPlayInfo&&(clearTimeout(this.uploadPlayInfo),this.uploadPlayInfo=!1),this.lessonName=o,this.dayId=t,this.lessonId=e,this.isReportEndEvent=!1,this.syncEndTimer&&(clearTimeout(this.syncEndTimer),this.syncEndTimer=null),this.isShowPlaybackRatesH5=!window.canHideFast,this.videoConfig={appId:window.appId,controlBar:{playbackRateMenuButton:!window.canHideFast,progressControl:!window.canHideFast},fileId:this.fileId,playAuth:this.playAuth,encryptMedia:this.encryptMedia,lessonId:e,isTCPlayer:this.isTCPlayer,autoplay:!0,playbackRates:this.playbackRates,definition:"240",plugins:{HLSToken:{token:"big_course"}},isBigCourse:!0,defaultDefinition:"HD",thumbnailUrl:this.vtt},this.$nextTick((function(){n.showModal=!0,setTimeout((function(){n.showModal=!1}),5e3)})))},changeShow:function(t){this.showKey=t},closeInitModal:function(){this.showModal=!1},startPlay:function(){this.player.setCurrentTime(0)},setRate:function(t){this.rateIndex=Number(t)},exitFullscreen:function(){this.player.exitFullscreen()},setPlayer:function(t){this.player=t,this.isShowFlowTip&&this.player&&this.player.pause()},canPlayHandler:function(){if(this.player){var t=Number(this.playNode)||0,e=this.player.getDuration();e&&e-t<=8&&(t=0),t&&this.player.setCurrentTime(t),this.setTooltipStyle(),this.bindRateDOMClick()}},bindRateDOMClick:function(){if(!this.isBindRateEvent){this.isBindRateEvent=!0;var t=document.querySelector(".vjs-playback-rate ul"),e=document.getElementsByTagName("video")[0];e&&t&&t.addEventListener("click",(function(){setTimeout((function(){sessionStorage&&sessionStorage.setItem("videoRate",e.playbackRate)}),500)}))}},playHandler:function(){this.isShowEndModal&&(this.isShowEndModal=!1,this.clearPlayNextTimer());var t=this.lessonId;"INIT"===this.playLessonStatus&&this.$emit("setLessonStatus",t,"UNFINISH"),this.isLandscape&&"INIT"===this.playLessonStatus&&this.$refs.controlModal.setLessonStudyStatus(t,"UNFINISH"),this.isPause=!1,this.isFirstCanplayReport||(this.showKey=2)},pauseHandle:function(){this.isPause=!0,this.showKey=1},timeupdateHandler:function(){this.syncPlayRecord(),this.syncReportHeart(),this.syncReportEndEvent()},syncPlayRecord:function(){var t=this;if(!this.uploadPlayInfo){var e=this.dayId,n=this.lessonId;this.uploadPlayInfo=setTimeout((function(){t.updateCourseLessonsHistory(!0,e,n),clearTimeout(t.uploadPlayInfo),t.uploadPlayInfo=!1}),3e3)}},syncReportHeart:function(){var t=this;this.reportHeartTimerId||(this.reportHeartTimerId=setTimeout((function(){(0,m.fetchCheckHeartbeat)(t.lessonId),t.clearHeartTimerId()}),1e4))},syncReportEndEvent:function(){var t=this;this.syncEndTimer||(this.syncEndTimer=setTimeout((function(){clearTimeout(t.syncEndTimer),t.syncEndTimer=null;var e=t.lessonId,n=t.dayId,o=t.player,i=t.isReportEndEvent;if(o&&!i){var s=(0,a.default)(o.getDuration()),r=(0,a.default)(o.getCurrentTime());s-r>20||!s||!r||(t.isReportEndEvent=!0,t.updateCourseLessonsHistory(!1,n,e),t.$nextTick((function(){"FINISH"!==t.playLessonStatus&&t.$emit("setLessonStatus",e,"FINISH"),t.isLandscape&&t.$refs.controlModal.setLessonStudyStatus(e,"FINISH"),t.emitPlaySyncTime()})))}}),1e3))},clearHeartTimerId:function(){clearTimeout(this.reportHeartTimerId),this.reportHeartTimerId=!1},endedHandler:function(){var t=this;clearTimeout(this.uploadPlayInfo),this.uploadPlayInfo=!1,this.clearHeartTimerId(),(this.isPc||this.isLandscape)&&(this.nextLessonId&&(this.playNextTimer=setTimeout((function(){t.$emit("switchLesson",t.nextLessonId),t.isShowEndModal=!1,t.playNextTimer=null}),3e3),this.$store.commit("autoPlayNextTimer",this.playNextTimer)),this.isShowEndModal=!0),this.emitPlaySyncTime(),setTimeout((function(){var e=t.videoConfig.isTCPlayer?".vjs-big-play-button":".prism-big-play-btn",n=document.querySelector(e);n&&(n.style.display="none")}),100)},emitPlaySyncTime:function(){var t=this;setTimeout((function(){t.$emit("playEnd")}),500)},errorHandler:function(t){(0,f.reportPlayInfo)((0,s.default)(this.getBasicInfo,{playInfo:(0,i.default)({isError:!0,error:{msg:(0,i.default)(t)}})}),!0),this.isShowFlowTip&&(this.isFirstShowFlowTip=!1)},updateCourseLessonsHistory:function(t,e,n){if("comment"!==this.$route.name){var o=t?(0,a.default)(this.player&&this.player.getCurrentTime(),10):0,i=this.$route.query.weekId,s={courseId:window.courseId,weekId:i,dayId:e,lessonId:n,playNode:o,mediaType:0,finish:!t};(0,m.fetchSaveHistory)(s)}},controlPlay:function(t){"replay"===t?this.player&&this.player.replay():"next"===t&&(this.isLandscape?this.$refs.controlModal.triggerNextLesson():this.$emit("switchLesson",this.nextLessonId)),this.isShowEndModal=!1,this.clearPlayNextTimer()},handlePlay:function(t){"next"===t?this.$emit("switchLesson",this.nextLessonId):"prev"===t&&this.$emit("switchPrevLesson")},setTooltipStyle:function(){var t=this;setTimeout((function(){var e=document.querySelector(".vjs-slider-bar .vjs-time-tooltip");e&&(e.style.display="none");var n=t.$refs.controlModal;if(t.isAndroid&&n&&n.initStyleAndDOM(),t.isShowFlowTip){var o=t.videoConfig.isTCPlayer?".vjs-big-play-button":".prism-big-play-btn",i=document.querySelector(o);i&&(i.style.display="none")}}),1e3)},playVideo:function(){this.isFirstShowFlowTip=!1,this.player&&this.player.play()},onOrientationChange:function(){var t=this,e="onorientationchange"in window?"orientationchange":"resize";window.addEventListener(e,(function(){180!==window.orientation&&0!==window.orientation||(t.isLandscape=!1,t.isShowEndModal=!1,t.clearPlayNextTimer()),90!==window.orientation&&-90!==window.orientation||(t.isLandscape=!0)}),!1)},switchContainer:function(t,e,n){this.$emit("switchContainer",t,e,n)},clearPlayNextTimer:function(){this.playNextTimer&&(clearTimeout(this.playNextTimer),this.$store.commit("autoPlayNextTimer",null))}}};e.default=v},4500:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"video-container",style:t.containerStyle},[n("VideoPlayer",{ref:"video",staticClass:"video-container",attrs:{"is-show-end-modal":t.isShowEndModal,"video-config":t.videoConfig},on:{setPlayer:t.setPlayer,canplay:t.canPlayHandler,play:t.playHandler,timeupdate:t.timeupdateHandler,pause:t.pauseHandle,ended:t.endedHandler,error:t.errorHandler,changeShow:t.changeShow}}),t._v(" "),t.isPc&&t.videoConfig.isTCPlayer?n("PcVideoPlayerControl",{attrs:{player:t.player,"next-lesson-id":t.nextLessonId,"prev-lesson-id":t.prevLessonId},on:{handlePlay:t.handlePlay}}):t._e(),t._v(" "),n("VideoPlayerEndModal",{attrs:{"is-show-end-modal":t.isShowEndModal,"is-landscape":t.isLandscape,"next-lesson-id":t.nextLessonId},on:{controlPlay:t.controlPlay}}),t._v(" "),t.isAndroid?n("VideoPlayerControlModal",{ref:"controlModal",attrs:{"playback-rates-h5":t.playbackRatesH5,"is-show-playback-rates-h5":t.isShowPlaybackRatesH5,"rate-index":t.rateIndex,"is-landscape":t.isLandscape,"player-content-data":t.playerContentData,"last-watch-lesson-id":t.lastWatchLessonId,"is-pause":t.isPause,"lesson-name":t.lessonName},on:{switchContainer:t.switchContainer,setRate:t.setRate,exitFullscreen:t.exitFullscreen}}):t._e(),t._v(" "),t.showInitInfo?n("MessageModal",{attrs:{"play-node":t.playNode},on:{startPlay:t.startPlay,close:t.closeInitModal}}):t._e(),t._v(" "),n("KeyModal",{attrs:{show:t.showKey},on:{changeShow:t.changeShow}}),t._v(" "),t.isShowFlowTip?n("div",{staticClass:"flow-tip"},[n("div",[t._v("\u5f53\u524d\u5904\u4e8e 2G/3G/4G \u7f51\u7edc")]),t._v(" "),n("button",{staticClass:"flow-tip-btn",on:{click:t.playVideo}},[t._v("\n            \u7ee7\u7eed\u64ad\u653e\n        ")])]):t._e()],1)},i=[]},459:function(t,e,n){t.exports=n(57)(16)},589:function(t,e,n){var o=n(716),i=n(717),s=n(512),a=n(718);t.exports=function(t){return o(t)||i(t)||s(t)||a()}},716:function(t,e,n){var o=n(462),i=n(491);t.exports=function(t){if(o(t))return i(t)}},717:function(t,e,n){var o=n(458),i=n(511),s=n(181);t.exports=function(t){if("undefined"!==typeof s&&i(Object(t)))return o(t)}},718:function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},727:function(t,e,n){"use strict";var o=n(45)(n(462)),i=e;i.escape=encodeURIComponent,i.unescape=function(t){return decodeURIComponent(t.replace(/\+/g," "))},i.stringify=function(t,e,n,o){if(!(l=t)||"[object Object]"!==s.call(l)||!("isPrototypeOf"in l))return"";var l;e=e||"&",n=n||"=",o=o||!1;var c,u,p=[],f=i.escape;for(c in t)if(a.call(t,c))if(u=t[c],c=i.escape(c),d(u))p.push(c,n,f(u+""),e);else if(r(u)&&u.length)for(var h=0;h<u.length;h++)d(u[h])&&p.push(c,(o?f("[]"):"")+n,f(u[h]+""),e);else p.push(c,n,e);return p.pop(),p.join("")},i.parse=function(t,e,n){"undefined"===typeof t&&(t=document.location.search);var o={};if("string"!==typeof t||0===l(t).length)return o;var s=(t=t.replace(/^\?/,"")).split(e||"&");n=n||"=";for(var d=i.unescape,c=0;c<s.length;c++){var u=s[c].split(n),p=d(l(u[0])),f=d(l(u.slice(1).join(n))),h=p.match(/^(\w+)\[\]$/);h&&h[1]&&(p=h[1]),a.call(o,p)?(r(o[p])||(o[p]=[o[p]]),o[p].push(f)):o[p]=h?[f]:f}return o};var s=Object.prototype.toString,a=Object.prototype.hasOwnProperty,r=o.default||function(t){return"[object Array]"===s.call(t)},l=String.prototype.trim?function(t){return null==t?"":String.prototype.trim.call(t)}:function(t){return null==t?"":t.toString().replace(/^\s+/,"").replace(/\s+$/,"")};function d(t){return t!==Object(t)}}}]);
//# sourceMappingURL=17.95f65ff.js.map